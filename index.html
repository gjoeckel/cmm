<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Canvas Course Video Manager</title>
  <style>
    :root { --fg: #1a1a1a; --bg: #f8f9fa; --accent: #0969da; --muted: #656d76; }
    * { box-sizing: border-box; }
    body { font-family: system-ui, -apple-system, sans-serif; margin: 0; padding: 1rem; background: #FFFFFF; color: var(--fg); line-height: 1.5; }
    .header { text-align: center; margin-bottom: 0; }
    .header h1 { font-size: 1.5rem; margin: 0 0 1rem; }
    .tabs { display: flex; flex-wrap: wrap; justify-content: center; gap: 0; margin: 0; padding: 0; list-style: none; }
    .tabs button { padding: 0.5rem 1rem; font-size: 0.875rem; font-family: inherit; border: none; border-top: 1px solid #ADADAD; border-left: 1px solid #ADADAD; border-right: 1px solid #ADADAD; border-bottom: 1px solid #ADADAD; background: #f6f8fa; cursor: pointer; border-radius: 6px 6px 0 0; }
    .tabs button:hover { background: #eee; }
    .tabs button.active { background: #fff; border-top: 2px solid #ADADAD; border-left: 2px solid #ADADAD; border-right: 2px solid #ADADAD; border-bottom: 1px solid #fff; margin-bottom: -1px; font-weight: 600; cursor: default; }
    .stats { font-size: 0.875rem; color: var(--muted); margin-bottom: 0; }
    .table-panel { }
    .table-wrapper { border: 2px solid #ADADAD; border-radius: 6px; overflow: hidden; margin-top: -1px; }
    table { width: 100%; border-collapse: collapse; font-size: 0.875rem; background: #fff; box-shadow: 0 1px 3px rgba(0,0,0,0.08); }
    th, td { padding: 0.5rem 0.75rem; border-bottom: 1px solid #eee; }
    td { text-align: center; }
    thead th { font-weight: 600; font-size: 1.25rem; color: var(--fg); text-align: center !important; border-bottom: 2px solid #CCC; }
    tbody th { font-size: 1.25rem; font-weight: inherit; text-align: left; background: transparent; }
    table col:nth-child(1) { width: 37%; }
    table col:nth-child(n+2) { width: 9%; }
    table tbody tr:nth-child(even) { background: #EFEFEF; }
    table tbody tr:hover { background: #fafafa; }
    a { color: var(--accent); text-decoration: none; }
    a:hover { text-decoration: underline; }
    .load-err { color: #cf222e; }
    .icon-placeholder { color: #333; display: inline-block; line-height: 0; }
    .icon-linked { color: #0000EE; display: inline-block; line-height: 0; text-decoration: none; }
    .icon-placeholder svg, .icon-linked svg { width: 24px; height: 24px; vertical-align: middle; }
    .skip-link { position: absolute; top: -100px; left: 0.5rem; padding: 0.5rem 0.75rem; background: var(--fg); color: var(--bg); font-size: 0.875rem; z-index: 100; border-radius: 4px; }
    .skip-link:focus { top: 0.5rem; }
  </style>
</head>
<body>
  <a href="#first-table-link" class="skip-link">Skip to first link in table</a>
  <div class="header">
    <h1>Canvas Course Video Manager</h1>
  </div>
  <div class="stats" id="stats" aria-live="polite"></div>
  <div class="table-panel">
    <div class="tabs" role="tablist" aria-label="Module">
      <button type="button" role="tab" data-value="" aria-selected="true" class="active">All</button>
      <button type="button" role="tab" data-value="Orientation">O</button>
      <button type="button" role="tab" data-value="M1">M1</button>
      <button type="button" role="tab" data-value="M2">M2</button>
      <button type="button" role="tab" data-value="M3">M3</button>
      <button type="button" role="tab" data-value="M4">M4</button>
      <button type="button" role="tab" data-value="M5">M5</button>
    </div>
    <div class="table-wrapper">
      <table>
        <colgroup><col><col><col><col><col><col><col><col></colgroup>
        <thead>
          <tr><th scope="col">Title</th><th scope="col">Time</th><th scope="col">ID</th><th scope="col">Au</th><th scope="col">Ai</th><th scope="col">Ae</th><th scope="col">Pr</th><th scope="col">Frame</th></tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </div>
  </div>

  <script>
    function escapeHtml(s) {
      const d = document.createElement('div');
      d.textContent = s;
      return d.innerHTML;
    }

    const ICONS = {
      au: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M430-200q38 0 64-26t26-64v-150h120v-80H480v155q-11-8-23.5-11.5T430-380q-38 0-64 26t-26 64q0 38 26 64t64 26ZM240-80q-33 0-56.5-23.5T160-160v-640q0-33 23.5-56.5T240-880h320l240 240v480q0 33-23.5 56.5T720-80H240Zm280-520v-200H240v640h480v-440H520ZM240-800v200-200 640-640Z"/></svg>',
      ai: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm40-80h480L570-480 450-320l-90-120-120 160Zm-40 80v-560 560Z"/></svg>',
      ae: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M352-120H200q-33 0-56.5-23.5T120-200v-152q48 0 84-30.5t36-77.5q0-47-36-77.5T120-568v-152q0-33 23.5-56.5T200-800h160q0-42 29-71t71-29q42 0 71 29t29 71h160q33 0 56.5 23.5T800-720v160q42 0 71 29t29 71q0 42-29 71t-71 29v160q0 33-23.5 56.5T720-120H568q0-50-31.5-85T460-240q-45 0-76.5 35T352-120Zm-152-80h85q24-66 77-93t98-27q45 0 98 27t77 93h85v-240h80q8 0 14-6t6-14q0-8-6-14t-14-6h-80v-240H480v-80q0-8-6-14t-14-6q-8 0-14 6t-6 14v80H200v88q54 20 87 67t33 105q0 57-33 104t-87 68v88Zm260-260Z"/></svg>',
      pr: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M360-240h160q17 0 28.5-11.5T560-280v-40l80 42v-164l-80 42v-40q0-17-11.5-28.5T520-480H360q-17 0-28.5 11.5T320-440v160q0 17 11.5 28.5T360-240ZM240-80q-33 0-56.5-23.5T160-160v-640q0-33 23.5-56.5T240-880h320l240 240v480q0 33-23.5 56.5T720-80H240Zm280-520v-200H240v640h480v-440H520ZM240-800v200-200 640-640Z"/></svg>',
      frame: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="m424-296 282-282-56-56-226 226-114-114-56 56 170 170Zm56 216q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"/></svg>'
    };

    function iconCell(href, svg) {
      if (href) return `<a href="${escapeHtml(href)}" class="icon-linked" target="_blank" rel="noopener">${svg}</a>`;
      return `<span class="icon-placeholder">${svg}</span>`;
    }

    function renderTable(videos) {
      const tbody = document.getElementById('tbody');
      tbody.innerHTML = videos.map((v, i) => `<tr>
        <th scope="row"><a ${i === 0 ? 'id="first-table-link" ' : ''}href="${escapeHtml(v.link || '#')}" target="_blank" rel="noopener">${escapeHtml(v.title || '')}</a></th>
        <td>${escapeHtml(v.duration || '—')}</td>
        <td>${escapeHtml(v.id || '—')}</td>
        <td>${iconCell(v.au, ICONS.au)}</td>
        <td>${iconCell(v.ai, ICONS.ai)}</td>
        <td>${iconCell(v.ae, ICONS.ae)}</td>
        <td>${iconCell(v.pr, ICONS.pr)}</td>
        <td>${iconCell(v.frame, ICONS.frame)}</td>
      </tr>`).join('');
    }

    let allVideos = [];

    function filterAndRender() {
      const activeTab = document.querySelector('.tabs button.active');
      const moduleFilter = activeTab ? activeTab.getAttribute('data-value') || '' : '';
      const filtered = moduleFilter
        ? allVideos.filter((v) => v.module === moduleFilter)
        : allVideos;
      renderTable(filtered);
    }

    document.querySelectorAll('.tabs button').forEach((btn) => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.tabs button').forEach((b) => { b.classList.remove('active'); b.setAttribute('aria-selected', 'false'); });
        btn.classList.add('active');
        btn.setAttribute('aria-selected', 'true');
        filterAndRender();
      });
    });

    fetch('./data/learning-activity-videos.json')
      .then((r) => { if (!r.ok) throw new Error(r.status); return r.json(); })
      .then((videos) => {
        allVideos = videos;
        filterAndRender();
      })
      .catch((err) => {
        document.getElementById('stats').innerHTML = '<span class="load-err">Failed to load videos: ' + escapeHtml(err.message) + '. Ensure data/learning-activity-videos.json exists.</span>';
      });
  </script>
</body>
</html>
